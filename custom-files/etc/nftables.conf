#!/usr/sbin/nft -f
#
# /etc/nftables.conf — default firewall for Void Linux custom ISO
#
# Policy: deny inbound by default, allow SSH + ping, allow all outbound.
# Edit this file then restart: sv restart nftables
#

# Wipe any existing rules on reload.
flush ruleset

table inet filter {

    chain input {
        type filter hook input priority 0; policy drop;

        # Loopback — always allow.
        iif "lo" accept

        # Established / related — allow replies to our own traffic.
        ct state established,related accept

        # Drop invalid packets early.
        ct state invalid drop

        # ICMP — allow ping (v4 and v6).
        ip  protocol icmp   accept
        ip6 nexthdr  icmpv6 accept

        # SSH — allow inbound on port 22.
        tcp dport 22 accept

        # ── Add custom inbound rules below this line ──
        # Examples:
        #   tcp dport 80  accept   # HTTP
        #   tcp dport 443 accept   # HTTPS
        #   tcp dport 631 accept   # CUPS (printing)

        # Everything else is dropped by the chain policy.
    }

    chain forward {
        type filter hook forward priority 0; policy drop;
        # No forwarding by default. If this machine routes traffic
        # (containers, VMs, NAT), add rules here.
    }

    chain output {
        type filter hook output priority 0; policy accept;
        # All outbound traffic is allowed.
    }
}
